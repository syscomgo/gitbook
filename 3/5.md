---
description: this is translated by machine
---

# HTTPS

## LINUX

### Ubuntu

### First step is to create an HTTPS certificate <a id="di-yi-bu-zhou-jian-li-https-ping-zheng"></a>

Install openssl 

```text
apt-get install openssl
```

Create ssl folder

```text
cd /etc/apache2/ 
mkdir ssl
```

Create a certificate

```text
openssl req -new -x509 -days 365 -nodes -out /etc/apache2/ssl/apache.pem -keyout /etc/apache2/ssl/apache.key
```

![](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MCPJ09KyLg4z4v3wlrY%2F-MCPN7euDx49_cLWgOX5%2F2020-07-17_092419.png?alt=media&token=9e612bd8-6229-4770-9a77-3051a7d9cc95)

Example of create a certificate

### Second step, modify django.conf <a id="di-er-bu-zhou-xiu-gai-djangoconf"></a>

```text
cd /etc/apache2/sites-available/
vi django.conf
```

Add the following code

```text
SSLEngine On
SSLCertificateFile /etc/apache2/ssl/apache.pem 
SSLCertificateKeyFile /etc/apache2/ssl/apache.key
```

**Port : 80 change to 443**

![](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MCPJ09KyLg4z4v3wlrY%2F-MCPPRLhRYdrCl2XWIpG%2F2020-07-17_093528.png?alt=media&token=2fab8c3b-7c40-41e1-9bae-27c475e9038d)

Example of modify django.conf 

### Third step is modify settings.py

file path： _/opt/omflow/server/omflow/settings.py_

```text
LOCAL_PROTOCOL = "http"
to
LOCAL_PROTOCOL = "https"
```

### Fourth step is to enable the SSL module <a id="di-san-bu-zhou-qi-yong-ssl-mo-zu"></a>

```text
a2enmod ssl
systemctl restart apache2
```

### Fifth step, check the OMFLOW webpage <a id="di-si-bu-zhou-jian-cha-omflow-wang-ye"></a>

Please enter **https://&lt;SERVER IP&gt;:443/**

![](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MCPJ09KyLg4z4v3wlrY%2F-MCPSzOaASiSprDsUf6D%2F2020-07-17_094804.png?alt=media&token=ba8c7f55-ebba-4a13-ae16-a949b8f8062c)

Confirm that the OMFLOW webpage is normal

### Centos

### First step is to create an HTTPS certificate <a id="di-yi-bu-zhou-jian-li-https-ping-zheng"></a>

install openssl 

```text
yum install openssl
```

Create a certificate 

```text
mkdir /etc/ssl/omcerts
openssl req -new -x509 -sha256 -days 365 -nodes -out /etc/ssl/omcerts/apache.pem -keyout /etc/ssl/omcerts/apache.key
```

install mod\_ssl

```text
yum install mod_ssl
```

### The second step is to modify httpd.conf

File path： /etc/httpd/conf/httpd.conf

Annotate the originally monitored ip and add https Port:

```text
# Change this to Listen on specific IP addresses as shown below to
# prevent Apache from glomming onto all bound IP addresses.
#
#Listen 12.34.56.78:80
#Listen 80
Listen 443

```

### The third step is to modify django.conf

```text
cd /etc/httpd/conf.d/
vi django.conf
```

add the following code，&lt;IP&gt;:443

```text
WSGIPassAuthorization On
WSGIDaemonProcess omflow python-path=/opt/omflow/server:/opt/omflow/python/lib/python3.6/site-packages
WSGIProcessGroup omflow
WSGIScriptAlias / /opt/omflow/server/omflow/wsgi.py

<IfModule mod_ssl.c>
<VirtualHost <IP>:443>

        Alias /static  /opt/omflow/server/staticfiles
        <Directory /opt/omflow/server/staticfiles>
                Require all granted
        </Directory>

        <Directory /opt/omflow/server/omflow>
                <Files wsgi.py>
                        Require all granted
                </Files>
        </Directory>
        SSLEngine on
        SSLCertificateFile      /etc/ssl/localcerts/apache.pem
        SSLCertificateKeyFile   /etc/ssl/localcerts/apache.key

</VirtualHost>
</IfModule>

```

modify django.conf

{% hint style="danger" %}
ssl.conf may appear under the conf.d folder, please remember to rename it
{% endhint %}

![](../.gitbook/assets/2020-12-29_100912.png)

### The fourth step, modify settings.py

File path： _/opt/omflow/server/omflow/settings.py_

```text
LOCAL_PROTOCOL = "http"
改為
LOCAL_PROTOCOL = "https"
```

### The fifth step, restart the service

```text
systemctl stop omflow_server
systemctl start omflow_server
```

### The sixth step, check the OMFLOW webpage

 **https://&lt;SERVER IP&gt;:443/**

![](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MCPJ09KyLg4z4v3wlrY%2F-MCPSzOaASiSprDsUf6D%2F2020-07-17_094804.png?alt=media&token=ba8c7f55-ebba-4a13-ae16-a949b8f8062c)

Confirm that the OMFLOW webpage is normal

## Windows

### The first step is to modify httpd.conf

File path： _C:\Program Files\OMFLOW Server\Apache24\conf\httpd.conf_

Annotate the originally monitored ip:

```text
# Listen: Allows you to bind Apache to specific IP addresses and/or
# ports, instead of the default. See also the <VirtualHost>
# directive.
#
# Change this to Listen on specific IP addresses as shown below to 
# prevent Apache from glomming onto all bound IP addresses.
#
#Listen 12.34.56.78:80
Listen <IP>:80


在上方第9行的最前方加上＃
#Listen <IP>:80
```

啟用ssl的設定檔

```text
# Secure (SSL/TLS) connections
# Note: The following must must be present to support
#       starting without SSL on platforms with no /dev/random equivalent
#       but a statically compiled-in mod_ssl.
#
<IfModule ssl_module>
#Include conf/extra/httpd-ssl.conf
#Include conf/extra/httpd-ahssl.conf
#SSLRandomSeed startup builtin
#SSLRandomSeed connect builtin
</IfModule>


將上方第7行的#拿掉
Include conf/extra/httpd-ssl.conf
```

### The second step is to modify httpd-ssl.conf

File path： _C:\Program Files\OMFLOW Server\Apache24\conf\extra\httpd-ssl.conf_

Add WSGI related code at the top of the file:

```text
LoadFile "C:\Program Files\OMFLOW Server\Python\python37.dll"
LoadModule wsgi_module "C:\Program Files\OMFLOW Server\Python\lib\site-packages\mod_wsgi\server\mod_wsgi.cp37-win32.pyd"
WSGIPythonHome "C:\Program Files\OMFLOW Server\Python"
WSGIScriptAlias / "C:/Program Files/OMFLOW Server/omflow/omflow/wsgi.py"
WSGIPythonPath "C:/Program Files/OMFLOW Server/omflow"

<Directory "C:/Program Files/OMFLOW Server/omflow/omflow">

<Files wsgi.py>

Require all granted

</Files>

</Directory>

Alias /static "C:/Program Files/OMFLOW Server/omflow/staticfiles"
<Directory "C:/Program Files/OMFLOW Server/omflow/staticfiles">

AllowOverride None

Options None

Require all granted

</Directory>

```

Add monitoring IP:

```text
# When we also provide SSL we have to listen to the 
# standard HTTP port (see above) and to the HTTPS port
#
# Note: Configurations that use IPv6 but not IPv4-mapped addresses need two
#       Listen directives: "Listen [::]:443" and "Listen 0.0.0.0:443"
#
Listen <IP>:443


```

```text
##
## SSL Virtual Host Context
##

<VirtualHost <IP>:443>

#   General setup for the virtual host
DocumentRoot "${SRVROOT}/htdocs"
ServerName <IP>:443
ServerAdmin admin@example.com
ErrorLog "${SRVROOT}/logs/error.log"
TransferLog "${SRVROOT}/logs/access.log"
```

New certificate path:

```text
#   Server Certificate:
#   Point SSLCertificateFile at a PEM encoded certificate.  If
#   the certificate is encrypted, then you will be prompted for a
#   pass phrase.  Note that a kill -HUP will prompt again.  Keep
#   in mind that if you have both an RSA and a DSA certificate you
#   can configure both in parallel (to also allow the use of DSA
#   ciphers, etc.)
#   Some ECC cipher suites (http://www.ietf.org/rfc/rfc4492.txt)
#   require an ECC certificate which can also be configured in
#   parallel.
SSLCertificateFile "C:\Program Files\OMFLOW Server\cert\cer\server.cer"
#SSLCertificateFile "${SRVROOT}/conf/server-dsa.crt"
#SSLCertificateFile "${SRVROOT}/conf/server-ecc.crt"

#   Server Private Key:
#   If the key is not combined with the certificate, use this
#   directive to point at the key file.  Keep in mind that if
#   you've both a RSA and a DSA private key you can configure
#   both in parallel (to also allow the use of DSA ciphers, etc.)
#   ECC keys, when in use, can also be configured in parallel
SSLCertificateKeyFile "C:\Program Files\OMFLOW Server\cert\pfx\server.key"
#SSLCertificateKeyFile "${SRVROOT}/conf/server-dsa.key"
#SSLCertificateKeyFile "${SRVROOT}/conf/server-ecc.key"
SSLCertificateChainFile "C:\Program Files\OMFLOW Server\cert\cer\uca.cer"
```

{% hint style="danger" %}
Credential path

server.cer 、 server.key 、 uca.cer

Please fill in according to the actual situation.
{% endhint %}

### The third step, modify settings.py

File path： _C:\Program Files\OMFLOW Server\omflow\omflow\settings.py_

```text
LOCAL_PROTOCOL = "http"
to
LOCAL_PROTOCOL = "https"
```

### The fourth step, restart the service

Open the service list, find OMFLOW Server and restart the service.

The service restart is complete to confirm whether the change is successful.


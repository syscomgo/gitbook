---
description: this is translated by machine
---

# Linux

## Linux version installation <a id="linux-ban-ben-an-zhuang"></a>

### Start to install OMFLOW Server <a id="kai-shi-an-zhuang-omflow-server"></a>

Preparing the environment for OMFLOW Server installation. This document uses Ubuntu16.04 and CentOS 7 as examples. For other operating systems, please refer to the following preparation steps to complete the preparation.

### First step, you must prepare the Python3 environment <a id="di-yi-bu-zhou-bi-xu-zhun-bei-python3-de-huan-jing"></a>

Ubuntu installation example

```text
apt-get install python3
```

CentOS installation example

```text
yum install python3
```

### Second step is to install the web server Apache Server <a id="di-er-bu-zhou-an-zhuang-wang-ye-si-fu-qi-apache-server"></a>

Ubuntu install Apache example

```text
sudo apt update
apt-get install apache2
```

CentOS install Apache example 

```text
yum install httpd
```

### Third step is to install mod\_WSGI <a id="di-san-bu-zhou-an-zhuang-modwsgi"></a>

mod\_wsgi is a simple and universal interface between a Web server and a Web application or framework defined for the Python language. It is a bridge between Django and Apache.

Ubuntu installation example

```text
apt-get install libapache2-mod-wsgi-py3
```

{% hint style="warning" %}
The Apache of Centos 7 must match the version of mod\_wsgi. It is not recommended to use yum install mod\_wsgi directly. It is recommended to install using the following instructions.
{% endhint %}

Centos installation example

```text
yum install -q -y centos-release-scl
sudo yum install -q -y rh-python36-mod_wsgi
cp /opt/rh/httpd24/root/usr/lib64/httpd/modules/mod_rh-python36-wsgi.so /lib64/httpd/modules
cp /opt/rh/httpd24/root/etc/httpd/conf.modules.d/10-rh-python36-wsgi.conf /etc/httpd/conf.modules.d
```

### Fourth step is to establish the python execution environment of omflow <a id="di-si-bu-zhou-jian-li-omflow-de-python-zhi-hang-huan-jing"></a>

```text
mkdir /opt/omflow
python3 -m venv /opt/omflow/python
```

{% hint style="warning" %}
If you cannot create a virtual environment, please install the package`apt-get install python3-venv`
{% endhint %}

### Fifth step is to install the necessary packages of omflow <a id="di-wu-bu-zhou-an-zhuang-omflow-bi-yao-tao-jian"></a>

Enter the virtual environment and install the necessary packages

```text
source /opt/omflow/python/bin/activate
pip install django==2.2
pip install ldap3
```

### Sixth step, unzip the omflow folder <a id="di-liu-bu-zhou-jie-ya-suo-omflow-zi-liao-jia"></a>

unzip /tmp/omflow.tar.gz 

```text
cd /opt/omflow 
tar zxvf /tmp/omflow.tar.gz
```

Rename the folder to **server**

```text
mv /opt/omflow/omflow /opt/omflow/server
```

### Seventh step, database preparation <a id="di-qi-bu-zhou-zi-liao-ku-zhun-bei"></a>

The database is currently SQLite by default. If you want to choose another database, please refer to the website

[Django database config](https://docs.djangoproject.com/en/2.2/ref/databases/)â€‹

If you want to choose another database, please create a database in advance to give the corresponding permissions. The following databases need to install additional packages \(install using pip\)

{% hint style="warning" %}
Please enter the virtual environment before installing the database package`source /opt/omflow/python/bin/activate`
{% endhint %}

#### Necessary kit comparison table:

| PostgreSQL | Oracle | SQL Server |
| :---: | :---: | :---: |
| psycopg2 | cx\_Oracle | django-mssql |
|  |  | django-pytds |
|  |  | django-sqlserver |
|  |  | django-pyodbc |

**change /opt/omflow/server/omflow/settings.py file  
The following is an example of settings.py modification**

**SQLite** `DATABASES = { "default": { "ENGINE": "django.db.backends.sqlite3", "NAME": os.path.join(BASE_DIR, "db.omflow"), "OPTIONS": {"timeout": 300,} } }`

**PostgreSQL** `DATABASES = { "default": { "ENGINE": "django.db.backends.postgresql", "NAME": "<Database Name>", "USER": "<User Name>", "PASSWORD": "<password>", "HOST": "<Database IP>", "PORT": "<Database PORT>", "OPTSIONS":{"connect_timeout":300} } }`

**MySQL** `DATABASES = { "default": { "ENGINE": "django.db.backends.mysql", "NAME": "<Database Name>", "USER": "<User Name>", "PASSWORD": "<password>", "HOST": "<Database IP>", "PORT": "<Database PORT>", "OPTSIONS":{"connect_timeout":300} } }`

**Oracle** `DATABASES = { "default": { "ENGINE": "django.db.backends.oracle", "NAME": "<Database Name>", "USER": "<User Name>", "PASSWORD": "<password>", "HOST": "<Database IP>", "PORT": "<Database PORT>" } }`

**SQL Server** `DATABASES = { "default": { "ENGINE": "sql_server.pyodbc", "NAME": "<Database Name>", "USER": "<User Name>", "PASSWORD": "<password>", "HOST": "<Database IP>", "PORT": "<Database PORT>", "OPTIONS":{"driver":"","MARS_Connection": True,} } }`

### Eighth step, execute the omflow\_config.sh file <a id="di-ba-bu-zhou-zhi-hang-omflowconfigsh-dang-an"></a>

Go to the /opt/omflow/server folder

```text
cd /opt/omflow/server 
./omflow_config.sh
```

### Ninth step, the type is selected as server <a id="di-jiu-bu-zhou-lei-xing-xuan-ze-wei-server"></a>

> omflow type : server

#### Ubuntu execution example <a id="ubuntu-zhi-hang-fan-li"></a>

![omflow type please enter server](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MBqfJS6C_rkH2evrLe7%2F-MBqi3YpfJaTCDc2Y8ms%2F2020-07-10_111126.png?alt=media&token=13e875c7-68e7-4cc0-8211-1bddef7ad215)

![After execution, a message indicating that the migration is complete will appear](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MBrf6hOupo0a_-nAlg7%2F-MBrhg55vPAyBhep5cSH%2F2020-07-10_155227.png?alt=media&token=f58bed82-3c7b-4181-a2ed-1039ad30e961)

#### Enable the django.conf configuration file <a id="qi-yong-djangoconf-she-ding-dang"></a>

The executable file has helped you copy django.conf \(apache configuration file\) to the apache folder can be viewed with commands

`vi /etc/apache2/sites-available/django.conf`

![ django.conf Profile screen](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MBrtrB7XBa2Rqfev1Eo%2F-MBruOsEjKxHaU9HoAiE%2F2020-07-10_160947.png?alt=media&token=fae981a0-d351-495f-8b87-595b7f9abad7)

Enable the django.conf configuration file 

```text
sudo a2ensite django.conf
```

Disable apache default file

```text
sudo a2dissite 000-default.conf
```

Restart the apache service

```text
service apache2 reload
```

#### Centos7 execution example <a id="centos-7-zhi-hang-fan-li"></a>

![omflow type please enter server](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MCBb7aBNEnBcJLhhnrD%2F-MCBlv_E0eZHoa48fYNE%2F2020-07-14_180300.png?alt=media&token=b53971e9-6e8b-48d8-8188-3c1a447d2b0c)

![After execution, a message indicating that the migration is complete will appear](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MCBb7aBNEnBcJLhhnrD%2F-MCBm8JbwPhu3xrJmap1%2F2020-07-14_180220.png?alt=media&token=8ef4995e-b5e2-4667-a060-ddfbe6a70dd5)

{% hint style="danger" %}
If Migrate has an error message django.core.exceptions.ImproperlyConfigured: SQLite 3.8.3 or later is required \(found 3.7.17\) The reason is that the SQLite version is too old.
{% endhint %}

#### Provide solutions <a id="ti-gong-jie-jue-ban-fa"></a>

```text
cd /tmp 
yum install wget
wget http://www6.atomicorp.com/channels/atomic/centos/7/x86_64/RPMS/atomic-sqlite-sqlite-3.8.5-3.el7.art.x86_64.rpm
yum localinstall atomic-sqlite-sqlite-3.8.5-3.el7.art.x86_64.rpm
mv /lib64/libsqlite3.so.0.8.6{,-3.17}
cp /opt/atomic/atomic-sqlite/root/usr/lib64/libsqlite3.so.0.8.6 /lib64
```

### Tenth step, enable omflow\_server service <a id="di-shi-bu-zhou-qi-yong-omflowserver-fu-wu"></a>

Start omflow\_server service

```text
systemctl start omflow_server
```

### Eleventh step, start enjoying OMFLOW <a id="di-shi-yi-bu-zhou-kai-shi-xiang-yong-omflow"></a>

## Start installation OMFLOW Collector <a id="kai-shi-an-zhuang-omflow-collector"></a>

### First step, you must prepare the Python3 environment <a id="di-yi-bu-zhou-bi-xu-zhun-bei-python3-de-huan-jing"></a>

Ubuntu Installation example 

```text
apt-get install python3
```

CentOS Installation example 

```text
yum install python3
```

### Second step is to establish the python execution environment of omflow <a id="di-si-bu-zhou-jian-li-omflow-de-python-zhi-hang-huan-jing"></a>

```text
mdkir /opt/omflow
python3 -m venv /opt/omflow/python
```

{% hint style="warning" %}
If you cannot create a virtual environment, please install the package`apt-get install python3-venv`
{% endhint %}

### Third step is to install the necessary packages for omflow <a id="di-wu-bu-zhou-an-zhuang-omflow-bi-yao-tao-jian"></a>

Enter the virtual environment and install the necessary packages

```text
source /opt/omflow/python/bin/activate
pip install django==2.2
```

### Fourth step, unzip the omflow folder <a id="di-liu-bu-zhou-jie-ya-suo-omflow-zi-liao-jia"></a>

Unzip /tmp/omflow.tar.gz 

```text
cd /opt/omflow 
tar zxvf /tmp/omflow.tar.gz
```

Rename the folder to **collector**

```text
mv /opt/omflow/omflow /opt/omflow/collector
```

### Fifth step is to execute the omflow\_config.sh file <a id="di-ba-bu-zhou-zhi-hang-omflowconfigsh-dang-an"></a>

Go to the /opt/omflow/collector folder

```text
cd /opt/omflow/collector 
./omflow_config.sh
```

### Sixth step, the type is selected as collector <a id="di-liu-bu-zhou-lei-xing-xuan-ze-wei-collector"></a>

> omflow type : collector

![omflow type please enter collector](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MBs2c3S94SzLwwcyjsS%2F-MBs9Rnm-nhWjBznsxs2%2F2020-07-10_173511.png?alt=media&token=c74aded4-1170-4113-b6a2-e5b8e67fd325)

### Seventh step, enter the required information <a id="di-qi-bu-zhou-shu-ru-bi-tian-zi-xun"></a>

This step will be changed **/opt/omflow/collector/omflow/settings.py**

* **Collector port : 5168**
* **Server IP : omflow server IP**
* **Server port : omflow server port**

![Please enter collector port&#x3001;omflow server IP&#x3001;omflow server port](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MBs2c3S94SzLwwcyjsS%2F-MBs9YpQMElUyolXmsuv%2F2020-07-10_173535.png?alt=media&token=3cd54d07-43e5-4886-9932-6267916ed76b)

![Screen after migration is complete](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MBs2c3S94SzLwwcyjsS%2F-MBsB38VI0YOqKgPDFnb%2F2020-07-10_173647.png?alt=media&token=35e14548-8639-4c72-b22b-3ca8e236c858)

### Eighth step, please check the omflow\_collecter service status <a id="di-ba-bu-zhou-qing-jian-cha-omflowcollecter-fu-wu-zhuang-tai"></a>

```text
systemctl status omflow_collector
```

![Service status is running](https://gblobscdn.gitbook.com/assets%2F-M6SrengyyhO1h0_BsJ_%2F-MBs2c3S94SzLwwcyjsS%2F-MBsBjXSMKVdq6KTNOcI%2F2020-07-10_180830.png?alt=media&token=ee199422-538c-44c6-bdd3-a11e40da8128)


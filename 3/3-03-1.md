
# アプリとプロセスの作成

アプリケーションとシンプルなプロセスの構築例を説明します。

## アプリケーションの作成

```
参照箇所：［メインメニュー］＞［アプリケーション管理］＞［アプリケーション設計］＞［新規］
```

メイン画面の上に**[新規]**ボタンをクリックして、「テスト」と入力します。作成したアプリケーションがリストに表示されます。

## プロセス作成

```
参照箇所：［メインメニュー］＞[アプリケーション管理]＞[アプリケーション設計]＞［アプリケーション名］
```

作成したアプリケーションをクリックして、プロセスリスト画面に入ります。メイン画面上の**[新規]**ボタンをクリックして、**[フォームプロセス]**を選択して、最初のプロセスを作成します。

プロセス作成後、プロセスの**[パラメータ設定]**画面に切り替わりますので、以下の項目を入力してください。  
● プロセス名：テストフロー  
● APIパス：practice-flow

> ※ この例では、他のチェックに入れた項目を変更しません。詳細については、【アプリケーション管理 > パラメーター設定設定】の節を参照してください。

## フォーム設計

```
参照箇所：［メインメニュー］＞[アプリケーション管理]＞[アプリケーション設計]＞［アプリケーション名］＞［アプリケーション名］＞［フォーム設計］
```

［フォーム設計］タブをクリックすると、空白のフォームが表示されます。メイン画面上の**[+ハーフブロック]**ボタンを2回クリックします。

左ブロックの**[+]**ボタンをクリックし、以下のフィールドを追加します：  
● タイトル  
● 入力

右ブロックの**[+]**ボタンをクリックし、以下のフィールドを追加します：   
● 状態  
● レベル

先ほど作成した**状態**フィールドで、**［齒車］**ボタンをクリックし**[オプション]**タブに切り替えて以下の[オプション]を追加します： 
 
| 值           | 表示文字       |
| ------------ | -------------- |
| 1 | 新規 |
| 2 | 審査 |
| 3 | 承認 |
| 0 | 拒否 |

## フロー設計

```
位置：［メインメニュー］＞[アプリケーション管理]＞[アプリケーション設計]＞［アプリケーション名］＞［アプリケーション名］＞［フロー設計］
```

［フロー設計］タブをクリックすると、デフォルトのフローが表示されます。このフローは意図的にクローズさないロジックで設計されているため、引き続きこのフローを修正します：

> 練習シナリオ：  
> ● 作成後“タイトル”と“入力”を加えて入力フィールドに入力し、ユーザーがチェックできるようにします  
> ● ユーザーが正しいことを確認したら、状態を承認に変更し、フローを完了します  
> ● ユーザーが承認以外の状態を選択した場合は、再び入力に戻ります

### コンポーネントの追加

画面上の**+新規**ボタンをクリックし、**コード**コンポーネントにチェックを入れます

### コンポーネント同士の結合

コンポーネント同士の結合を説明する前に、フロー設計の3種類の操作を紹介します。

#### コンポーネントのドラッグ＆ドロップ    
> ● ［コンポーネント］をドラッグ＆ドロップ
 
#### リンクの作成    
> ● 結合元としての［コンポーネント］をクリックし、操作状態に入ります  
> ● 操作状態で「左、右、下」の任意の**○**ボタンを〇ボタンが緑色になるまでクリックします  
> ● マウスを結合先となる［コンポーネント］の上に移動します  
> ● 表示された任意の**○**ボタンをクリックします

#### リンクの削除  
> ● 結合元としての［コンポーネント］をクリックし、操作状態に入ります  
> ● 操作状態で「左、右、下」の任意の**○**ボタンを〇ボタンが緑色になるまでクリックします   
> ● 方法1：もう一度緑色になった**○**ボタンをクリックします  
> ● 方法2：マウスを結合先となる［コンポーネント］の上に移動し、結合先とリンクしている**○**ボタンをクリックします

フロー設計の3種類の操作が理解できましたら、以下の作業を行ってください。  
● 「開始、入力」の間のリンクを削除します  
● 先ほど作成した「実行（コード）」のコンポーネントを「開始、入力」の間にドラッグ＆ドロップします  
● 次の順番でコンポーネント同士を結合させます：開始 → 実行 → 入力 → 判斷 → 完了  
● 「判断」のコンポーネントをさらに結合させます：判断 → 入力

### コンポーネントの設定

フローの構成が完成したら、各コンポーネントの機能、入力、出力を設定します。


#### 「開始」コンポーネント  

```
            参照箇所：〔フロー設計］＞〔開始コンポーネント］＞［齒車］＞〔入力］＞〔+作成］
```

フローの[開始コンポーネント]をクリックして操作状態に入り、上記の順番で指定された場所を見つけ、以下の設定をします：

| データ入力     | 引数名       | 説明           |
| ------------ | -------------- | -------------- |
| success | result |   |
| フィールド：タイトル | title |   |
| フィールド：入力 | input |   |
|  | python_result |   |

> ※ これはプロセスの開始変数であり、他のコンポーネントでも可能です。

#### 「コード」コンポーネント  

##### 「入力」タブ

```
            参照箇所：〔フロー設計］＞〔コード コンポーネント］＞［齒車］＞[入力]＞〔作成］
```

フローの[開始コンポーネント]をクリックして操作状態に入り、上記の順番で指定された場所を見つけ、以下の設定をします：

| データ入力      | 引数名       | 說明           |
| ------------ | -------------- | -------------- |
| 変数：title | a |   |
| 変数：input | b |   |
|  | c |   |

> ※ a、b、cは、pythonコード内で扱う変数で、ここで作成した変数のみフロー内で扱うことが可能です。 

##### 「Python」タブ

```
            参照箇所：〔フロー設計］＞〔コード コンポーネント］＞［齒車］＞［Python］
```

様々な利用者のニーズを満足するため、ここでは自分でPythonコードを入力することができます、この例では、mergeInputの方法を定義し、a、bの変数を文字列として結合して、最後に結合した結果を返します。詳細は以下の例を参照してください。

```python
def mergeInput(title, text):
    ans = title + text
    return ans


c = mergeInput(a,b)
```

> ※ プロセスから入力される変数はすべて**string**型です。

##### 「出力」タブ

```
            参照箇所：〔フロー設計］＞〔コード コンポーネント］＞［齒車］＞［出力］
```

ここでは、出力タブのどの変数をプロセス変数に渡すかを決めるため、以下の設定をしてください。

| データ入力     | 引数名       | 説明           |
| ------------ | -------------- | -------------- |
| 変数：c | python_result |   |

#### 「フォーム入力」コンポーネント

フォーム入力の主な機能は、プロセスを停止させ、ユーザーの手動処理により、再度プロセスを動かすことです。 ここでは、プロセスがこのコンポーネントに入るたびに、**状態**フィールドの値が**審査**に変更されるように設定します。

| 引数名      | フィールド設定     | 説明           |
| ------------ | -------------- | -------------- |
| 2 | フィールド：状態 |   |

#### 「条件判断」コンポーネント 

このコンポーネントは、複数の他コンポーネントとの結合を設定し、条件によってどのルートに進むかを決めます。

| 分岐先のコンポーネント     | 変数またはフィールド     | 条件           | 值             |
| ------------ | -------------- | -------------- | -------------- |
| 入力(FITEM_2) | フィールド: 状態 | ノットイコール | 3 |
| 終了(FITEM_4) | フィールド: 状態 |   | イコール | 3 |


> ※ 条件判断要素が複数のルートを同時に満たす場合、一番下のルートを優先します。

## 保存

フロー設計が完了したら、メイン画面右上の**保存**ボタンをクリックします。

> ※ プロセスを保存してもすぐには反映されません。反映させるには**リリース**を実行する必要があります。

## リリース

```
参照箇所：［メインメニュー］＞［アプリケーション管理］＞［アプリケーション設計］
```

**[アプリケーション設計]**をクリックしてアプリケーションリストに戻り、先ほど作成したアプリケーションを選択し、メイン画面上部の**[リリース]**ボタンをクリックします。 **[新しいアプリのリリース]**を選択し、**[確認する]**をクリックします。

すでにこのアプリをリリースした場合は、**既存アプリと置き換える**を選択してください。

> ※ アプリのサイズによってリリースに時間がかかる場合があります。その場合はリリース完了までお待ちください。

## フォームの作成

```
参照箇所：［メインメニュー］＞〔Apps］＞〔アプリケーション名］＞〔プロセス名］
```

リリース完了後、上記の場所に該当のプロセスがありますので、**[新規]**ボタンをクリックしてフォームを作成できます。


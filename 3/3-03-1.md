
# 建立應用及流程

本章節將示範如何建立並設計一個簡單的流程。

## 建立應用

```
位置：［主選單］＞應用管理＞應用設計＞新增
```

於主畫面上方點擊**新增**按鈕，輸入「練習應用」並按下**確定**按鈕，列表中會顯示出剛才建立的應用。

## 新建流程

```
位置：［主選單］＞應用管理＞應用設計＞［應用名稱］
```

點擊剛才建立的應用，則會進入流程列表畫面。並於主畫面上方點擊**新增**按鈕，選擇**表單流程**以建立第一個新流程。

建立後會切換到流程的**參數設定**介面，請完成下列欄位：  
● 流程名稱：練習流程  
● API路徑：practice-flow

> ※ 本次範例不修改其他勾選項目，詳細可參考【應用管理>參數設定】章節

## 表單設計

```
位置：［主選單］＞應用管理＞應用設計＞［應用名稱］＞［流程名稱］＞表單設計
```

點擊「表單設計」頁籤，會看到一張空白表單。點擊主畫面上方**半區塊**按鈕兩次。

點擊左邊區塊的**＋**按鈕，加入以下欄位：  
● 標題  
● 輸入

點擊右邊區塊的**＋**按鈕，加入以下欄位：  
● 狀態  
● 燈號

在方才建立的**狀態**欄位上，點擊［**齒輪**］按鈕並切換到**選項**頁籤，新增以下選項： 
 
| 值           | 顯示文字       |
| ------------ | -------------- |
| 1 | 新建 |
| 2 | 審核 |
| 3 | 通過 |
| 0 | 拒絕 |

## 流程設計

```
位置：［主選單］＞應用管理＞應用設計＞［應用名稱］＞［流程名稱］＞流程設計
```

點擊「流程設計」頁籤，會看到預設流程，此流程刻意設計成不會關單的邏輯，接下來將流程進行修改：

> 練習情境：  
> ● 開單後會將“標題”跟“輸入”相加，回填到輸入欄位後讓使用者檢查  
> ● 使用者確定無誤後將狀態改為通過，並結束流程  
> ● 若使用者選擇的狀態並非通過，則再次回到人工輸入元件

### 新增元件

點擊上方**新增**按鈕，勾選**程式碼**元件

### 連結元件

在進行連結前，先介紹設計流程路線的三種操作：

#### 拖曳元件  
> ● 按住［元件］不放  
> ● 移動滑鼠
 
#### 建立連結  
> ● 點擊視為起點的［元件］進入互動狀態  
> ● 點擊互動狀態「左、右、下」任一**○**按鈕，至呈現綠色  
> ● 滑鼠移至視為終點的［元件］上方  
> ● 點擊任一浮現的**○**按鈕

#### 刪除連結  
> ● 點擊視為起點的［元件］進入互動狀態  
> ● 點擊附有連結的**○**按鈕，至呈現綠色  
> ● 方法一：再點擊一次綠色的**○**按鈕  
> ● 方法二：滑鼠移至視為終點的［元件］上方，點擊連結終點的的**○**按鈕

了解操作後，請完成下列目標：  
● 刪除「開始、人工輸入」之間的連結  
● 將方才建立的「執行(程式碼)」元件，拖曳至「開始、人工輸入」中間  
● 依照此順序連結各元件：開始 → 執行 → 人工輸入 → 判斷 → 結束  
● 於「判斷」元件額外建立一條連結：判斷 → 人工輸入

### 設定元件

流程圖架構完成後，接下來要設定每個元件的功能、輸入、輸出。


#### 「開始」元件  

```
            位置：流程設計＞〔開始元件］＞［齒輪］＞輸入＞新增
```

點擊流程圖上的〔開始元件］進入互動狀態，透過上面順序找到指定位置，並完成以下設定：

| 輸入資料     | 變數名稱       | 說明           |
| ------------ | -------------- | -------------- |
| success | result |   |
| 欄位：標題 | title |   |
| 欄位：輸入 | input |   |
|  | python_result |   |

> ※ 此處設定的是流程的起始變數，可供其他元件帶入使用

#### 「程式碼」元件  

##### 「輸入」頁籤

```
            位置：流程設計＞〔程式碼元件］＞［齒輪］＞輸入＞新增
```

點擊流程圖上的〔程式碼元件］進入互動狀態，透過上面順序找到指定位置，並完成以下設定：

| 輸入資料     | 變數名稱       | 說明           |
| ------------ | -------------- | -------------- |
| 變數：title | a |   |
| 變數：input | b |   |
|  | c |   |

> ※ a、b、c為流程帶入python代碼中的變數，也只有在此建立的變數才能帶回流程。

##### 「Python」頁籤

```
            位置：流程設計＞〔程式碼元件］＞［齒輪］＞Python
```

此處能自行輸入Python代碼以滿足各種客戶需求，本次範例定義了一個mergeInput的方法，並將a、b變數進行字串相加，最後回傳相加結果，以下為範例：

```python
def mergeInput(title, text):
    ans = title + text
    return ans


c = mergeInput(a,b)
```

> ※ 所有從流程輸入的變數，都是**string**型態。

##### 「輸出」頁籤

```
            位置：流程設計＞〔程式碼元件］＞［齒輪］＞輸出
```

此處將決定輸入頁籤的變數有哪些要寫回流程變數中，請完成下列設定：

| 輸入資料     | 變數名稱       | 說明           |
| ------------ | -------------- | -------------- |
| 變數：c | python_result |   |

#### 「人工處理」元件 

人工處理元件主要功能為停止流程，再交由使用者手動處理並堆單使流程繼續前進。此處我們將設定每當流程進入此元件時，**狀態**欄位值會變更為**審核**。

| 輸入資料     | 設定欄位       | 說明           |
| ------------ | -------------- | -------------- |
| 2 | 欄位：狀態 |   |

#### 「條件判斷」元件 

此元件可設定多條連結，並根據條件決定走哪一條。

| 下一元件     | 變數或欄位     | 條件           | 值             |
| ------------ | -------------- | -------------- | -------------- |
| 人工輸入(FITEM_2) | 欄位：狀態 | 不相等 | 3 |
| 結束(FITEM_4) | 欄位：狀態 |   | 相等 | 3 |


> ※ 當條件判斷元件同時滿足多條路線時，會優先以最下方路線前進。

## 儲存

當流程設計完成後，點選主畫面右上角的**儲存**按鈕。

> ※ 流程儲存後並不會立即生效，需要進行**上架**動作才會生效。

## 上架

```
位置：［主選單］＞應用管理＞應用設計
```

點擊**應用設計**回到應用列表，勾選剛才建立的應用，接著點擊主畫面上方的**上架**按鈕。選擇**上架新應用**，接著點擊**確認**。

若已經上架過此應用，則選擇**取代上架應用**進行覆蓋。

> ※ 上架時將根據應用資料大小需等待一段時間，請耐心等候。

## 開立表單

```
位置：［主選單］＞Apps＞〔應用名稱］＞〔流程名稱］
```

上架完畢後，即可在上述位置找到該流程的資料列表，點擊**新增**按鈕即可開立表單。


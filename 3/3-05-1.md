# 承認メカニズム

### 用語の定義(共通)

1. クリック：マウスでクリックが必要な部分で、太字で表示されます。
2. 変数：ダイナミックまたは非固定のテキストへの参照は、[ ]でプロンプトが表示されます、例えば、[ユーザー名]
3. コンポーネント：プロセス設計の各オブジェクトの通称です。
4. フィールド：一般的に入力可能なインターフェイスのことです。本システムではフォーム設計の入力できるフィールドのことも指します。
5. タブ：インターフェイスやウィンドウの複数シートオプション
6. ブロック：フィールドの集まり、一般的に上に名称が表示されます。
7. 章：名称が【10.1】の数字の場合は、このパート（検証メカニズム）の第10.1章を意味し、名称が文字の場合は、他の章の内容への参照の意味です。

## はじめに

バージョン1.1.6.3から、OMFLOWは承認機能を提供しています。承認機能は、複雑な承認プロセスに対応し、ユーザーが承認プロセスのステータスを追跡できるように設計されています。これまでのワークフローとは異なり、設定によりコンポーネントに承認機能を追加することで、承認テンプレート、追加承認/コメントなどを利用できるようになります。

また、OMFLOWの組織図機能では複数の組織図を追加できるようになり、組織図の使い方がさらに広がりました。複数の組織図を登録可能なため、組織のタスクやプロジェクトの組織を作る際に大変便利です。

## 1 グループ構造

複数の組織図を作成できるようになり、部門組織図の職務/権限、部門の職務/権限のコンポーネントで、特定の組織図に関する情報を参照できます。また、承認設計に追加した組織図を指定することもできます。

### 1.1 組織図の追加
```
参照箇所：［メインメニュー］＞［ユーザー管理］＞［グループ構造］＞［+新規］
```
新しい組織図を追加するには、[+新規]ボタンをクリックします。組織図の名前は一意である必要があり、重複してはいけません。

### 1.2 組織図の編集
```
参照箇所：［メインメニュー］＞［ユーザー管理］＞［組織図］＞［任意の組織図］
```
既存の組織図をクリックすると、編集モードに入ります。詳細は８章を参照してください。

### 1.3 組織図の削除
```
参照箇所：［メインメニュー］＞［ユーザー管理］＞［組織図］
```
削除したい組織図にチェックを入れ、[削除]ボタンをクリックすることで削除できます。

> 注意事項：  
> 1. 組織図を削除すると、関連する「委託管理された組織図」も削除されます。  
> 2. 削除後は復元できません。

## 2 職務管理
```
参照箇所：［メインメニュー］＞［ユーザー管理］＞［職務管理］
```
[職務管理]にOMFLOW内でのユーザーの職務に関連するすべての設定が保存されます。「 承認デザイン」を設定する際、[職務管理]の情報を職務リストとして参照します。またここも「組織図、部門」の基礎となり、関連する担当者に職務を設定します。

### 2.1 職務の追加
```
参照箇所：［メインメニュー］＞［ユーザー管理］＞［職務管理］＞[+新規]
```
「職務管理」画面の左上にある[+新規]ボタンをクリックすることで、新しい職務を追加できます。関連する設定は以下のとおりです。  
1. **職務名**：職務を識別するための名前です。  
2. **ジョブコード**：一意な値であり、職務をエクセルにインポートする際、このデータを追加/修正の基準としても使用できます。  
3. **説明**：職務に関しての簡単な紹介文です。 
4. **その他の権限**：該当の職務のデフォルトの権限であり、「組織図、部門」で職務を設定する際に自動的に入力されます。

### 2.2 職務の編集
```
参照箇所：［メインメニュー］＞［ユーザー管理］＞［職務管理］＞[編集]
```
設定は２．１章と同様。

## 3 部門

バージョン1.1.6.3にアップデート後、企業の実際の承認作業フローが部門の構成と一致している場合、組織図コンポーネントも部門構成からの直接検索が可能です。関連する承認設定は以下のとおりです。

### 3.1 デフォルト部門の設定
```
参照箇所：［メインメニュー］＞[ユーザー管理]＞[ユーザ管理]＞［任意のユーザ］＞[デフォルトの部門]項目
```
承認の第一段階に入る際、「職務権限」を利用して承認者を探す場合、一般的には承認者の「デフォルトの部門」を組織図の開始点として使用します。例えば、「ユーザーA」の「予算責任者」を探す場合、組織図の「ユーザーA」のデフォルト部署を開始点として検索します。

> 注意事項：  
> 1. ユーザーがデフォルトの部門を設定しない場合、以下の優先順位ルールが出発点として使用されます。  
> (1) ユーザーが組織図上で該当する職務を有する部門  
> (2) ユーザーが所属する部門の中、番号の最も小さい部門

### 3.2 部門職務権限の設定
```
位置：［メインメニュー］＞[ユーザー管理]＞［部門管理]＞ ［任意の部門］＞［職務権限]
```
部門設定インターフェイスで直接「職務権限」を設定することができます。関連する操作の詳細については、詳細は９章を参照してください。

## 4 承認

バージョン1.1.6.3の新機能で、主に特定の操作や決定が一連の承認手順やプロセスを経ていることを確認するために使用されます。一般的な使用例としては、書類の承認、人事プロセス、プロジェクト管理、契約締結などで使用されます。以下では、まず関連する用語について説明します。  
1. **承認デザイン**　：承認管理で追加され、作成後の承認デザインはプロセス設計のフォーム入力コンポーネントとして使用することができます。  
2. **承認者**　：承認の判断や意見を述べる人で、承認ごとに複数の「承認者」を設定できます。  
3. **送信者**　：承認プロセスを開始する人で、1回の承認に対して設定できる「送信者」は1人だけです。  
4. **追加承認者**　：承認者が自ら決定することができないと判断した場合、または今回の承認に他の人の同意が必要であると判断した場合、承認者は、今回の「承認」に、まだ承認者となっていない人を追加承認者として指名し、承認の補佐することができます。

### 4.1承認管理
```
参照箇所：［メインメニュー］＞［アプリケーション管理］＞［承認管理］
```
ここにはOMFLOWの承認に関するすべての設定が保存され、プロセスデ設計に適用されるすべての承認設計はここから取得されます。

#### 4.1.1 承認デザインの新規追加
```
参照箇所：［メインメニュー］＞［アプリケーション管理］＞［承認管理］＞[+新規]
```
「承認管理」画面の上部にある[+新規]ボタンをクリックすることで、新しい承認デザインを追加できます。詳細の設定は以下のとおりです。  
1. **設定**：このタブでは、名前、説明、通知方法など、承認デザインの基本情報を設定できます。詳細は１０．１章を参照してください。  
2. **インプット**：このタブは「承認デザイン」のすべての「内蔵パラメータ」を表示し、変数名と説明を自分で入力することもできます。詳細は１０．２章を参照してください。  
3. **フェーズ**：このタブは、承認プロセスにおいていくつかの承認段階を設定できます。例えば、休暇はまず申請者が確認してから、次に部門長が確認するなどのケースで承認プロセスが段階的になります。詳細は１０．３章を参照してください。  
4. **通知するユーザ**：このタブは、ユーザーに「通知」する承認通知の「件名、内容」を設定します。「htmlタグ」を使って編集することができ、また、以前に入力したタブの「内蔵パラメータ」を使うこともできます。
5. **Python**：この承認の「承認者検索」を外部システムのAPIに問い合わせる必要がある場合、このタブではAPI処理のためのコードを入力することができます。それ以外にも、「入力」タブの内蔵パラメータを使用することもできます。

> 注意事項：  
> (1) コードで非オリジナルパッケージを使う場合、上の新規ボタンをクリックし、パッケージ名を記入してください。  
> (2) 書き終えたら、「段階」タブにある承認者タイプの「外部検索」で適用できます。  
> (3) このタブでは関連する例と出力のフォーマットに関する注釈が記載されます。

#### 4.1.2 承認デザインの編集
```
参照箇所：［メインメニュー］＞［アプリケーション管理］＞［承認管理］＞［任意の承認デザイン］
```
関連する設定は４．１．１章と同様です。

#### 4.1.3 承認デザインの削除
```
参照箇所：［メインメニュー］＞［アプリケーション管理］＞［承認管理］＞［削除したい承認デザインにチェックを入れる］＞[削除]
```
テンプレートを「削除」したい場合は、テンプレート名の前にあるチェックボックスにチェックを入れ、画面左上の[削除]ボタンをクリックします。削除後のテンプレートは復元できません。

## 5 フロー設計

1.1.6.3の承認のメカニズムは「フロー設計」と密接に関連しています。以下に関連する機能を記載します。

### 5.1 承認フィールド
```
参照箇所：［メインメニュー］＞［アプリケーション管理］＞［アプリケーション設計］＞［任意のアプリケーション］＞［任意のプロセス］＞[フォーム設計]タブ＞［任意のブロック］＞[+]ボタン＞[※承認]フィールド
```
承認を任意の位置に置くことができ、承認処理後フォームのコンポーネントに「承認履歴」を表示します。

> 注意事項：  
> フローの承認機能を有効にする際に必要なフィールドです。

### 5.2 フォーム入力コンポーネント
```
参照箇所：［メインメニュー］＞［アプリケーション管理］＞［アプリケーション設計］＞［任意のアプリケーション］＞［任意のプロセス］＞[フロー設計]タブ＞フォーム入力コンポーネント＞[設定]タブ＞承認機能を有効にする
```
「承認」は、フォーム入力コンポーネントに連結しているため、使用するには[承認機能を有効にする]にチェックを入れる必要があります。注意点として、一度 「承認機能」を有効にすと、少なくとも1つの承認デザインと承認段階が条件を満たしている必要があります。満たさない場合、画面の左下に 「承認状態を確認できない」が表示され、プロセスを続行することができません。関連操作の詳細は、１１章を参照してください。

### 5.3 組織図関連のコンポーネント

#### 5.3.1 部門組織図の職務/権限
```
参照箇所：［メインメニュー］＞［アプリケーション管理］＞［アプリケーション設計］＞［任意のアプリケーション］＞［任意のプロセス］＞[フロー設計]タブ＞[+新規]＞[組織図]タブ＞[部門組織図の職務/権限]
```
「部門組織図の職務/権限」は組織図、部門、職務管理と連結して、「ユーザ番号」と「ジョブコード/權限名」を入力することで、ユーザーが組織図に所属する「部門/組織」を起点に、最も近い「ジョブコード/権限名」を検索し（ユーザー所属のレイヤーから）、ユーザーの「ユーザ番号、部門番号」を返信します。 
1. **ジョブコード**：検索したいジョブコード/権限名を入力する  
2. **ユーザ番号**：ユーザ番号をインポートする  
3. **検索方法**：検索方法を組織図または部署から選択する  
4. **組織図名**：組織図に関する検索の場合は、組織図名を入力する必要がある  
5. **組織図の立ち位置表示**：ここに別の組織図コンポーネントの出力の座標を記入できる

#### 5.3.2 部門の職務/権限
```
位置：［メインメニュー］＞［アプリケーション管理］＞［アプリケーション設計］＞［任意のアプリケーション］＞［任意のプロセス］＞[フロー設計]タブ＞[+新規]＞[部門の職務/権限]
```
「部門の職務/権限」は組織図、部門、職務管理と連結して、「部門番号(ID)」/部門コード」を入力することで、該当の部門が組織図に所属する「部門/組織」を起点に、最も近い「ジョブコード/権限名」を検索し、ユーザーの「ユーザ番号、部門番号」を返信します。   
1. **部門コード**：検索したい部門番号(ID)/部門コードを入力する   
2. **ジョブコード**：検索したいジョブコード/権限名を入力する 
3. **検索方法**：検索方法を組織図または部署から選択する   
4. **組織図名**：組織図に関する検索の場合は、組織図名を入力する必要がある

### 5.4 承認判定のコンポーネント
```
参照箇所：［メインメニュー］＞［アプリケーション管理］＞［アプリケーション設計］＞［任意のアプリケーション］＞［任意のプロセス］＞[フロー設計]タブ＞[+新規]＞[ルート]タブ＞[承認判定]
```
「プロセス コンポーネント：承認判定」は、承認機能が有効になっている時に手動で処理する要素と組み合わせて使用される承認判定であり、この承認判定が合意されたか否かの後に、どこに進むべきかをシステムに通知します。

## 6 承認の進め方

ユーザーに割り当てられた後、以下の方法で承認を実行できます。

### 6.1 クイック操作
```
参照箇所：［メインメニュー］＞[マイタスク]＞[タスクリスト]タブ
```
「承認フロー」がユーザーに割り当てられると、ユーザーは[マイタスク]で承認することができます。

> 注意事項：  
> 1. この機能を使用するには、[承認デザイン]で[クイック操作を許可]にチェックを入れる必要があります。

### 6.2 フォームの操作
```
参照箇所：［メインメニュー］＞[マイタスク]＞[タスクリスト]タブ＞［任意の承認フロー］
```
[マイタスク]から該当のフローで承認機能を実行でき、フォームの内容と承認記録を確認することもできます。

#### 6.2.1 追加承認
例えば、承認の際に、ユーザーが他の役員の同意を求める必要があり、「承認デザイン」で「追加承認を許可」にチェックが入っている場合、ユーザーはフォームの上部または下部にある「追加承認」ボタンをクリックし、以下の操作を実行できます。

1. **同意して追加承認**：「同意して追加承認」を選択した場合、現在の承認の担当者は「同意する」で承認プロセスに返送し、同時に追加承認のユーザーを選択します。ユーザーは該当の承認段階で承認に指定されしていないユーザーだけを選択することができ、このオプションで承認者として選択されたユーザーは、現在の承認の担当者から完全な重み付けを取得します。

2. **意見募集して返事を待つ**：「意見募集して返事を待つ」を選択した場合、現在の承認の担当者の動作が保留され、先に追加された承認者にプロセスが送信されます。現在の承認の担当者は、追加された承認者のコメントが返信されるまで承認することができます。コメントが返信される前に現在の承認の担当者が承認を実行した場合、この状況がシステムによって自動的に追加された承認者に返信します。ユーザーは該当の承認段階で承認に指定されていないユーザーだけを選択することができ、追加された承認者は現在の承認の重み付けを取得せず、現在の承認の担当者に保留します。

#### 6.2.2 意見募集

承認の際、「承認」フィールドにコメントを入力する欄があります。現在の承認の担当者が、プロセス中にコメントやアイデアを入力し、同意するかどうかを選択すると、システムはフォーム上のフィールドに承認履歴とコメントを表示します。

## 7 代理承認
```
参照箇所：［メインメニュー］ ＞[ユーザー管理]＞[ユーザ管理]＞ ［任意のユーザー］＞[高度な代理]タブ
```
ユーザーがOMFLOWで「休暇」ステータスにある場合、承認フォームはユーザーの「代理人」に割り当てられます。以下の2つの代理人モードがあります。

### 7.1承認代理人の新規追加
```
参照箇所：［メインメニュー］ ＞[ユーザー管理]＞[ユーザ管理]＞ ［任意のユーザー］＞[高度な代理]タブ＞[承認代理人]
```
[承認]と[代理人]を選択することで、当該ユーザーに承認が割り当てられるたびに、[代理人]に指定されたユーザーは代理人として操作することになります。

### 7.2職務代理人の新規追加
```
参照箇所：［メインメニュー］ ＞[ユーザー管理]＞[ユーザ管理]＞ ［任意のユーザー］＞[高度な代理]タブ＞[職務代理人]
```
[職務]と[代理人]を選択することで、職務で割り当てれた場合、すべての承認で当該のユーザーが代理人となります。

> 注意事項：  
> 1. 「休暇」期間中に作成された承認フローのみが、代理人の[マイタスク]に表示されます。  
> 2. 両方の代理条件を満たす場合、「承認代理人」が優先されます。

## 8 組織図の操作説明
```
参照箇所：［メインメニュー］ ＞[ユーザー管理]＞[グループ構造]＞［任意の組織図］
```
```
参照箇所：［メインメニュー］ ＞[ユーザー管理]＞[グループ構造]＞[+新規]
```
### 8.1 基本情報の設定

組織図を設計する際、まず組織図の基本情報を以下のように設定します。

1. **組織図名**：組織図名のユニークな値を入力してください。

2. **設定**：「組織図名」フィールドの右側をクリックすると、以下のような設定インターフェイスがポップアップ表示されます。

3. **フローがこの図にデータを見つからない場合、さらに部門データを検索し、条件を満足したユーザに情報を返送します**：プロセス設計の 「ダイレクト職務/権限、部門の職務/権限」のコンポーネントは、指定した組織図で設定した条件を満たすユーザーを優先的に検索します。 このオプションにチェックを入れた後、条件を満たすユーザーが組織図で見つからない場合、システムは部門データでさらに条件を満たすユーザーを検索します。

4. **管理部門&管理ユーザ**：組織図が組織の一部を委託管理責任者に「委託管理」し、委託管理責任者がそれを編集して承認に送信すると、システムは自動的にプロセス「組織図管理プロセス」フローを生成し、設定された管理者に割り当て、[マイタスク]で確認することができます。

### 8.2 組織構成の設定

初期の「組織図」には1つの組織アイコンのみがあり、ツリー構造の最上位階層であり、通常は組織図の最上位に位置付けます。アイコンの[歯車]ボタンをクリックして設定します。以下は関連設定の説明です。 
1. **部門名** ：代表する部署を選択します。カスタムにチェックを入れる場合、システムに登録されていない部門とみなされますので、名称を入力する必要があります。  
2. **部門番号** ：上記で説明したとおり、[カスタム]にチェックが入っている場合は、名前を入力し、組織図ではユニークな値である必要があります。 
3. **部門** ：読み取り専用で、設計に従って所属する部門名を示します。  
4. **所屬部門番号**：読み取り専用で、設計に従って部門コード示します。    
5. **委託管理**  ：チェックを入れた後、委託管理責任者を設定できます。  
6. **委託管理者**：ユーザーを設定し、設定後この組織以下のツリー構造を隠し、指定したユーザーに管理権限を渡します。  
7. **部門の職務/責任者**：この部門の職務と権限は、９章を参照してください。  

> 注意事項：  
> 
> (1) 部門のカスタムは、通常、恒久的ではない特別な部門構成で利用します。例えば、異なる部門が集まったプロジェクトチームで使用し、プロジェクトの期間中に組織図検索機能を使って、チームメンバーにタスクを割り当てることができます。
> 
> (2) 「委託管理」ボックスにチェックを入れると、システムは指定された「委託管理者」に組織とその下位組織の委託管理を出します。委託管理された組織は委託がキャンセルされるまで編集できないことに注意してください。 「委託管理者」のメインメニューに「[ユーザー管理]＞グループ構造」が表示され、委託管理者は「委託管理」されてた組織を編集できます。保存をクリックすると「組織図リスト」ページに戻り、組織図の末尾に[審査に提出]ボタンが表示され、委託管理者はボタンをクリックすると、組織図に割り当てられている「管理ユーザ」の[マイタスク]に審査タスクが与えられ、同意すると変更を保存できます。同意しない場合、再度委託管理者に戻り、再審査またはクローズするか確認されます。

設定完了後、最初の「組織」アイコンの+ボタンをクリックして、その組織の下に空の組織を追加します。この手順で必要なツリー構造を作成し、[保存]ボタンをクリックして設計を完了します。

### 8.3 その他の機能

[保存]ボタンのほかにも、以下のようなボタンがあります。

1. **エクスポート**：現在「保存」されている組織図をエクセルファイルにエクスポートする。

2. **インポート**：ユーザーがエクセルファイルの形でデータメンテナンスできます。

> 注意事項：  
> (1) エクセルファイルのフォーマットは決まっているので、実際にエクスポートしたエクセルファイルを参照してください。  
> (2) インポートする前に、対応する「職務、部門」情報がシステム内に作成されていることを確認してください。  
> (3) インポートの際、「部門番号とジョブコード」で追加・修正を行う基準にします。  
> (4) 利用すると、現在の組織図の構造が変更されます。

3. **キャンセル**：現在未保存の編集を破棄し、「組織図」リストに戻ります。

## 9 職務権限の操作説明
```
参照箇所：［メインメニュー］ ＞［ユーザー管理］＞［部門管理］＞ ［任意の部門］＞［職務權限］
```
```
参照箇所：［メインメニュー］ ＞［ユーザー管理］＞［組織図］＞ ［任意の組織図］＞［任意の組織図アイコン］＞歯車ボタン
```
### 9.1 職務権限の新規追加

編集モードの[職務権限]ブロックで[+新規]ボタンをクリックすると、表示される設定は以下のとおりです。
1. **職務**：職務管理の「すべての職務」のドロップダウンメニューで構成されます。  
2. **ユーザ**：職務を任意のユーザーに割り当てます。  
3. **権限**：ユーザーのニーズに応じて追加、改修、削除が可能です。

### 9.2 職務權限の削除

1. **以下の職務を削除します**：職務権限右上にあるXアイコンをクリックして「職務権限」を削除します。  
2. **以下の権限を削除します**：特定の職務の権限を単独で削除します。各権限の末尾に[ゴミ箱]アイコンがあり、クリックすると「特定の権限責任」を削除できます。ここでの修正は職務管理のデフォルト権限と責任に影響しません。

> ※ 部門設定の調整が完了後、左上の［保存］ボタンをクリックして有効にします。

## 10 承認デザイン操作の説明
```
参照箇所：［メインメニュー］＞[アプリケーション管理]＞[承認管理]＞[+新規]
```
```
参照箇所：［メインメニュー］＞[アプリケーション管理＞[承認管理]＞［任意の承認デザイン］
```
### 10.1「設定」タブの操作

1. 件名：テンプレートの名前を記入する。
2. 説明：承認テンプレートの説明や備考情報を記入する。
3. 承認通知設定：  
(1) **承認者に通知する**：[承認者に通知する]にチェックを入れると、「フロー設計」でこの「承認デザイン」が使用され、プロセス中にこのトリガーされると、この段階の承認者に通知されます。
(2) **送信者に通知する**：[送信者に通知する]にチェックを入れると、その後の承認段階の各段階の「送信者」に通知します。  
(3) **通知方法**：  
**システム通知**：[システム通知]を選択すると、「承認段階」ごとに「承認通知」 がユーザーに送信されます。  
**メールアドレス**：[メールアドレス]を選択すると、「承認段階」ごとに「承認通知」 がユーザーのメールアドレスに送信されます。 この機能を使用する場合、メールを正常に送信するために、「パラメータ設定」で「smtp server」関連のパラメータが入力されている必要があることに注意してください。  
(4) **通知フォーマット**：  
**プレーンテキスト**：[プレーンテキスト]のテキスト形式を選択すると、「通知」タブに入力されたテキストが「プレーンテキスト」形式で表示されます。  
**Html**：[html]のテキスト形式を選択すると、[通知するユーザ]タブで「htmlタブ」の形式でテキストの内容が表示されます。

### 10.2 「入力」タブの操作

1. **内蔵パラメータ**：「承認デザイン」の内蔵パラメータであり、[通知するユーザ]タブと[Python]タブで使用でき、[通知するユーザ]タブで使用する場合は「内蔵パラメータ」を{}に入れることで利用できます。

2. **変数入力**：[変数入力]とは、変数を「承認デザイン」と「プロセス」でそれぞれ「名前」と「値」が与えられ、「段階」タブで使用します。

### 10.3 「段階」タブの操作

1. **新規**：[+新規]ボタンをクリックして、新しい「承認段階」 を追加する。  
&nbsp;(1) **件名** ：承認段階の「件名」を入力するフィールドです。 
&nbsp;(2) **説明** ：承認段階の「說明」を入力するフィールドです。 

2. **承認段階を設定**：承認段階の設計。  
(1) **クイック操作を許可**：[クイック操作を許可]をチェックすると、承認者は、[メイン メニュー]>[マイタスク]>[タスクリスト]>「クイック操作」で、今回の審査に同意または拒否を直接選択できます。
(2) **追加承認を許可**：[追加承認を許可]にチェックを入れると、その後の審査の段階では[追加承認を許可]ボタンが表示され、この段階ではまだ「承認者」でないユーザーを「追加承認者」に指定できます。
(3) **複数承認**：[追加承認]にチェックを入れると、この段階で新たに「承認者」を追加することができ、承認フローが複数の承認者に同時に送信され、[承認結果を判断]ブロックが表示され、以下の「3つの判定方法」のいずれかを選択できます。
**全員が同意する**：[全員が同意する]が選択された場合、すべての承認者が同意しない限り、次のステージに進みません。拒否がある場合、結果は拒否になりこの承認フローが終了します。
**重み付けの境界**：[重み付けの境界]を選択すると、[承認の重み付けが境界に達する場合は次のように見なされる]ブロック、[カスタム重み付け]チェックボックス、[承認の重み付けの閾値までで今のフェーズを終了]チェックボックスが表示されます。それぞれの説明は下記のとおりです。「承認の重み付けが境界に達する場合は次のように見なされる」は2つのチェックボックスがあり、[同意する]にチェックを入れ、重み付けが閾値に達すると、承認段階の結果は「同意する」となり、[拒否する]にチェックを入れると、結果は「拒否」となります。「承認の重み付けの閾値までで今のフェーズを終了」は、重み閾値に達したときに、すべての承認監督者の回答が終わるのを待たずに、署名段階を終了することができる項目です。
**重み付けの比較**：[重み付けの比較]を選択すると、[承認の重み付けが同等の場合は]ブロックと、[カスタム重み付け]というチェックボックスが表示されます。
「承認の重み付けが同等の場合は」には、[同意する]、[拒否する]の2つのチェックボックスがあります。[同意する]にチェックを入れると、承認の段階で、「同意する」と「拒否する」の重みの合計が等しい場合、結果は「同意する」と判定されます。[拒否する]にチェックを入れると「拒否」となります。[カスタム重み付け]にチェックを入れると、承認者の重み付けフィールドのロックが解除され、
ユーザーが設定したい重み付けを入力できるようになります。そのため、重み付けフィールドが変更されると、「カスタム重み付け」のオプションは自動的にチェックが入れます。
(4) **承認者**：ここでは、フローを発送する「承認者」を検索または指定することができ、[インプット]タブで入力した[変数入力]と合わせて利用することができます。承認者ブロックには、[重み付け]、[件名]、[種類]、[承認者]のフィールドがあり、それぞれのブロックの機能は次のように説明します。
**重み付け**：このフィールドの値は「複数承認」状態にカスタマイズでき、承認結果に影響します。  
**名前**：このフィールドには、「承認者」の名前を入力できます。  
**種類**：このフィールドには、承認者の「送付フロー」を検索でき、「指定者」、「組織図検索」、「部門検索」、「外部検索(Python)」の4つの種類があり、それぞれについて以下で説明します。

> **指定者**：「承認者」フィールドの後に部門とユーザーメニューが表示され、指定したい部門やユーザーを選択し、または「変数」を入力します。
> 
> **組織図検索**：「承認者」フィールドの後に組織図名と検索方法メニューが表示され、「組織図名」に検索したい組織図名や「変数」を入力し、「検索方法」で検索方法を選択します。詳細は１０．４章を参照してください。
> 
> **部門検索**：「承認者」フィールドに検索方法メニューが表示され、詳細は第10.4章を参照してください。    
> 
> **外部検索(Python)**：PythonタブでPythonコードを使用して承認者を検索することができます。システムが自動的に検索した承認者を外部検索フィールドに記入します。  

### 10.4 検索方法

承認デザインにおける検索方法について紹介します。「承認者」ブロックの種別で「組織図検索、部門検索」を選択すると、「承認者」フィールドに検索方法メニューが表示され、「ダイレクト職務、ダイレクト権限、部門の職務、部門の権限」の4種類があり、それぞれについて以下のように説明します。

1. **ダイレクト職務**：ダイレクト職務で検索する場合、後方のフィールドに「職務名」、「ユーザ番号」を入力するか、「変数」または「内蔵パラメータ」を選択する必要があります。システムは「組織図」/「部門管理」のユーザ番号に従って入力した職務名を検索しします。

> ※検索結果のユーザ番号と同じ場合は、検索を上方向に続けて対象者を探します。
```
例：

検索条件の職務名に部長と入力し、ユーザーAのユーザ番号が1の場合、検索条件はＡがいる部門のユーザーを検索し、さらに上方に検索して、承認責となる職務が部長であるユーザーを探すことです。
```
2. **ダイレクト権限**：ダイレクト権限で検索する場合、後方のフィールドに「権限名」、「ユーザ番号」を入力するか、「変数」または「内蔵パラメータ」を選択する必要があります。システムは「組織図」/「部門管理」のユーザ番号に従って入力した権限名を検索しします。

> ※検索結果のユーザー番号と同じ場合は、検索を上方向に続けて対象者を探します。
```
例：

検索条件の権限名に予算配分と入力し、ユーザーBのユーザ番号が2の場合、検索条件はBがいる部門のユーザーを検索し、さらに上方に検索して、予算配分権限がある承認責を探すことです。
```
3. **部門の職務**：部門の業務で検索する場合、後方のフィールドに「職務名」と「部門コード」を入力する必要があり、システムは部門コードに従って「組織図」/「部門管理」に入力した職務名を検索します。

4. **部門の権限**：部門の権限で検索する場合、後方のフィールドに「権限名」と「部門コード」を入力する必要があり、システムは部門コードに従って「組織図」/「部門管理」に入力した権限名を検索します。

## 11 フォーム入力コンポーネント-承認機能の起動と操作の說明
```
位置：［メインメニュー］＞［アプリケーション管理］＞［アプリケーション設計］＞［任意のアプリ］＞［任意のプロセス］＞［フロー設計］タブ ＞［フォーム入力コンポーネント］＞[設定]タブ＞［承認機能を有効にする］
```［
### 11.1 「設定」タブの操作

[承認機能を有効にする]にチェックを入れると、[設定]タブに[送信者を指定]メニューと[直接送信]チェックボックスが表示されます。

1. **送信者を指定**：ここに今回の「送信者」ユーザー番号を記入でき、プロセス変数で代用することもできます。送信者を設定すると、承認者は[メインメニュー]->[マイタスク]->[割り当てられたデータ]で「送信者名」を確認できるようになり、承認プロセス中に承認者を検索照会する際に、「送信者」で組織図を検索することもできます。 

2. **直接送信**：通常、システムは承認フローを「譲受人」に送り、譲受人はそれが正しいことを確認した後、承認フローを承認者に送信します。 しかし、設定時点で「直接送信」にチェックを入れると、承認フローは譲受人を経由せず、直接承認者に送信して承認処理が行われます。 

3. **その他の状況**：「譲受人、直接送信」のそれぞれの条件でシステムが送信者を決定する状況を以下に示します。
* 「直接送信」 → 「送信者」未指定 → 「送信者」は「system」
* 「直接送信」 → 送信者を指定 →「 送信者」は「指定送信者」
* 非「直接送信」 → 送信者未指定 → 譲受人あり → 「送信者」は「譲受人」
* 非「直接送信 」 → 送信者未指定 → 譲受人なし → 「送信者」は管理者
* 非「直接送信」 → 送信者を指定 → 譲受人あり/なし → 「送信者」は「指定送信者」
* 非「直接送信」 → 送信者を指定 → 譲受人あり/なし → 「送信者」は「指定送信者」

### 11.2 「承認」タブの操作
```
位置：［メインメニュー］＞［アプリケーション管理］＞［アプリケーション設計］＞［任意のアプリ］＞［任意のプロセス］＞［フロー設計］タブ＞［フォーム入力コンポーネント］＞[設定]タブ＞［承認機能を有効にする］＞[承認する]タブ
```
このタブの主な目的は、ユーザーがフォーム入力コンポーネントで承認を送付する際に、承認デザインに必要な入力変数を以下のように設定します。

1. **+作成**：[承認する]タブの左上隅にある追加を使用することで、異なる「承認デザイン」を追加することができます。

2. **承認名**：[承認名]は、「承認管理」の承認デザインから選択できます。

3. **ユーザーによる調整を許可**：[ユーザーによる調整を許可]にチェックが入っている場合、「譲受人」は「承認」を送信する前に、「新しい段階を追加」するかどうかを決定することができ、システム上では「追加承認」と設定されます。

4. **条件**：承認デザインごとに条件を設定することができ、条件を満たした「承認デザイン」が表示され、「送信者」を選択することができます。

5. **承認設定**：[承認設定]ブロックには、[入力]、[段階]の 2 つのタブがあり、[入力]タブで承認デザイン「変数入力」に値を割り当て、[段階]タブで承認デザインの各段階の条件を設定できます。

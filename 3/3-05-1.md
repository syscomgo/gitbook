# 承認メカニズム

## 承認メカニズム

#### 備考(共通)

1. クリック：マウスでクリックが必要な部分で、太字で表示されます。
2. 変数：ダイナミックまたは非固定のテキストへの参照は、\[ ]でプロンプトが表示されます、例えば、\[ユーザー名]
3. コンポーネント：プロセス設計の各オブジェクトの通称です。
4. フィールド：一般的に入力可能なインターフェースのことです。本システムではフォーム設計の入力できるフィールドのことも指す。
5. タブ：インターフェイスやウィンドウの複数シートオプション
6. ブロック：フィールドの集まり、一般的に上に名称が表示されます。
7. 章：名称が【10.1】の数字の場合は、このパート（検証メカニズム）の第10.1章を意味し、名称が文字の場合は、他の章の内容への参照の意味です。

### 前言

11.1.6.3から、OMFLOWは承認機能を提供します。承認機能は、複雑な許可プロセスに対応し、ユーザーが承認の状態を追跡できるように設計されています。これまでのワークフローとは異なり、設定によりコンポーネントに承認機能を追加したら、承認テンプレート、追加承認/コメントなどを利用できるようになります。

また、OMFLOWの組織図が複数の組織図を追加できるようになり、組織図の使い方がさらに広がりました。複数の組織図があれば、組織のタスクやプロジェクトの組織を作る際に大変便利です。

### 1 組織図

複数の組織図を作成できるようになり、部門組織図の職務/權限、部門の職務/權限のコンポーネントに、特定の組織図に関する情報を照会できます。また、承認設計に追加した組織図を指定することもできます。

#### 1.1 組織図の追加

```
位置：［メインメニュー］＞ユーザー管理＞組織図＞新規
```

新しい組織図を追加するには、\[新規]ボタンをクリックします。組織図の名前は一意は一意である必要があり、重複してはいけません。

#### 1.2 組織図の編集

```
位置：［メインメニュー］＞ユーザー管理＞組織図＞［任意の組織図］
```

既存の組織図をクリックすると、編集モードに入ります。詳細は第【8】章を参照してください。

#### 1.3 組織図の削除

```
位置：［メインメニュー］＞ユーザー管理＞組織図
```

削除したい組織図にチェックを入れ、上の削除ボタンをクリックして削除できます。

> 注意事項：
>
> 1. 組織図を削除すると、関連する「委託管理された組織図」も削除されます。
> 2. 削除後に復元できません。

### 2 職務管理

```
位置：［メインメニュー］＞ユーザー管理＞職務管理
```

ここにOMFLOWのジョブに関連するすべての設定が保存されます。「 承認デザイン」を設定する際、ここの情報を職務リストとして参照します。またここも「組織図、部門」の基礎となり、関連する担当者にジョブを設定します。

#### 2.1 職務の追加

```
位置：［メインメニュー］＞ユーザー管理＞職務管理＞新規
```

「職務管理」画面の左上にある新規ボタンをクリックすることで、新しい職務を追加でき、関連する設定は以下の通りです。

1. **職務名**：職務を識別するための文字です。
2. **ジョブコード**：一意の値であり、職務をexcelにインポートする際、このデータで追加/修正の基準としても使用されます。
3. **說明**：職務に関して簡単な紹介文です。
4. **その他の權限**：該当の職務のデフォルトの権限であり、「組織図、部門」で職務を設定する際に自動的に入力されます。

#### 2.2 職務の編集

```
位置：［メインメニュー］＞ユーザー管理＞職務管理＞編集
```

設定は大【2.1】章と同様。

### 3 部門

バージョン1.1.6.3にアップデート後、企業の実際の承認作業が部門構成と一致している場合、組織図コンポーネントも部門構成からの直接検索をサポートし、関連の承認設定は以下のとおりです。

#### 3.1 デフォルト部門の設定

```
位置：［メインメニュー］＞ユーザー管理＞ユーザ管理＞［任意のユーザ］＞「デフォルトの部門」項目
```

承認の第一段階に入る際、「職務權限」を通じて承認者を探す場合、一般的には承認者の「デフォルトの部門」を組織図の開始点として使用します。例えば、「ユーザーA」の「予算責任者」を探す場合、組織図の「ユーザーA」のデフォルト部署を開始点として検索します。

> 注意事項：
>
> 1. ユーザーがデフォルトの部門を設定しない場合、以下の優先順位ルールが出発点として使用されます。\
>    (1) ユーザーが組織図上で該当する職務を有する部門\
>    (2) ユーザーが所属する部門の中、番号の最も小さい部門

#### 3.2 部門職務權限の設定

```
位置：［メインメニュー］＞ユーザー管理＞部門管理＞ ［任意の部門］＞「職務權限」
```

部門設定インターフェイスで直接「職務權限」を設定することができます。関連する操作の詳細については、詳細は第【9】章を参照してください。

### 4 承認

OMFLOWバージョン1.1.6.3新機能で、主に特定の操作や決定が一連の承認手順やプロセスを経ていることを確認するために使用され、一般的は書類の承認、人事プロセス、プロジェクト管理、契約締結などで使用されます。以下では、まず関連する用語について説明します。

1. **承認デザイン**　：承認管理で追加され、作成後承認デザインはプロセス設計のフォーム入力コンポーネントとして使用することができます。
2. **承認者**　：承認の判断や意見を述べる人で、承認ごとに複数の「承認者」を設定できます。
3. **送信者**　：承認プロセスを開始する人で、1回承認に対して「送信者」は1人だけです。」
4. **追加承認者**　：承認者が自ら決定することができないと思う場合、または今回の承認に他の人の同意が必要であると思う場合、承認者は、今回の「承認」に、まだ承認者となっていない人を追加承認者として指名し、承認の補佐とさせることができます。

#### 4.1承認管理

```
位置：［メインメニュー］＞アプリケーション管理＞承認管理
```

ここにはOMFLOWの承認に関するすべての設定が保存され、プロセスデ設計に適用されるすべての承認設計はここから取得されます。

**4.1.1 承認デザインの新規追加**

```
位置：［メインメニュー］＞アプリケーション管理＞承認管理＞新規
```

「承認管理」画面の上部にある新規ボタンをクリックして、新しい承認デザインを追加できます。詳細の設定は下記のとおりです。

1. **設定**：このタブでは、名前、説明、通知方法など、承認デザインの基本情報を設定できます。詳細は第\[10.1]章を参照してください。
2. **入力**：このタブは「承認デザイン」のすべての「内蔵パラメータ」を表示し、変数名と説明を自分で入力することもできます。詳細は第\[10.2]章を参照してください。
3. **段階**：このタブは、承認プロセスにおいていくつかの承認段階が存在することを決定します。例えば、休暇はまずチームリーダーによって確認してから、次に部門長によって確認するなど、詳細は第\[10.3]章を参照してください。
4. **通知**：このタブは、ユーザーに「通知」する承認通知の「件名、内容」を設定します。「htmlタグ」を使って編集することができ、また、以前に入力したタブの「内蔵パラメータ」を使うこともできます。
5. **Python**：この承認の「承認者検索」は外部システムのAPIに問い合わせる必要がある場合、このタブではコードを入力でき、または「入力」タブの内蔵パラメータを使用することもできます。

> 注意事項：\
> (1) コードで非オリジナルパッケージを使う場合、上の新規ボタンをクリックし、パッケージ名を記入してください。\
> (2) 書き終えたら、「段階」タブにある承認者タイプの「外部検索」で適用できます。\
> (3) このタブでは関連する例と出力のフォーマットに関する注釈が記載されます。

**4.1.2 承認デザインの編集**

```
位置：［メインメニュー］＞アプリケーション管理＞承認管理＞［任意の承認デザイン］
```

関連設定は第【4.1.1】章と同様です。

**4.1.3 承認デザインの削除**

```
位置：［メインメニュー］＞アプリケーション管理＞承認管理＞［削除したい承認デザインにチェックを入れ］＞削除
```

テンプレートを「削除」したい場合は、テンプレート名の前にあるチェックボックスにチェックを入れ、画面左上の「削除」ボタンをクリックします。削除後のテンプレートは復元できません。

### 5 フロー設計

1.1.6.3の承認のメカニズムは「フロー設計」と密接に関連しており、下記に関連する機能を記載します。

#### 5.1 承認フィールド

```
位置：［メインメニュー］＞アプリケーション管理＞アプリケーション設計＞［任意のアプリケーション］＞［任意のフロー］＞フォーム設計タブ＞［任意のブロック］＞＋ボタン＞「※承認」フィールド
```

承認を任意の位置に置くことができ、承認処理後フォームのコンポーネントに「承認履歴」を表示します。

> 注意事項：\
> l フローの承認機能を有効にする際に必要なフィールドです。

#### 5.2 人工處理元件

```
位置：［メインメニュー］＞アプリケーション管理＞アプリケーション設計＞［任意のアプリケーション］＞［任意のフロー］＞フロー設計タブ＞フォーム入力コンポーネント＞タブの設定＞承認機能を有効にする
```

「承認」は、フォーム入力コンポーネントに連結しているため、使用するには「承認機能」を有効にチェックを入れる必要があります。注意点として、一度 「承認機能」を有効にすと、少なくとも1つの承認デザインと承認段階が条件を満たしている必要があり、そうでなければ、画面の左下隅に 「承認状態を確認できない」が表示され、プロセスを続行することはできません。関連操作の詳細は、第【11】章を参照してください。

#### 5.3 組織図関連のコンポーネント

**5.3.1 部門組織図の職務/權限**

```
位置：［メインメニュー］＞アプリケーション管理＞アプリケーション設計＞［任意のアプリケーション］＞［任意のフロー］＞フロー設計タブ＞新規＞組織図タブ＞部門組織図の職務/權限
```

「部門組織図の職務/權限」は組織図、部門、職務管理と連結して、「ユーザ番号」と「ジョブコード/權限名」を入力することで、ユーザーが組織図に所属する「部門/組織」を起点に、最も近い「ジョブコード/權限名」を検索し（ユーザー所属のレイヤーから）、ユーザーの「ユーザ番号、部門番号」を返信します。

1. **ジョブコード/權限名**：検索したいジョブコード/權限名を入力する
2. **ユーザ番号**：ユーザ番号を輸入する
3. **検索方法**：検索方法を組織図または部署から選択する
4. **組織図名**：組織図に関する検索の場合は、組織図名を入力する必要がある
5. **組織図の立ち位置表示**：ここに別の組織図コンポーネントの出力の座標を記入できる

**5.3.2 部門の職務/權限**

```
位置：［メインメニュー］＞アプリケーション管理＞アプリケーション設計＞［任意のアプリケーション］＞［任意のフロー］＞フロー設計タブ＞新規＞部門の職務/權限
```

「部門の職務/權限」は組織図、部門、職務管理と連結して、「部門番号(ID)」/部門コード」を入力することで、該当の部門が組織図に所属する「部門/組織」を起点に、最も近い「ジョブコード/權限名」を検索し、ユーザーの「ユーザ番号、部門番号」を返信します。

1. **部門番号(ID)」/部門コード**：検索したい部門番号(ID)」/部門コードを入力する
2. **ジョブコード/權限名**：検索したいジョブコード/權限名を入力する
3. **検索方法**：検索方法を組織図または部署から選択する
4. **組織図名**：組織図に関する検索の場合は、組織図名を入力する必要がある

#### 5.4 承認判定のコンポーネント

```
位置：［メインメニュー］＞アプリケーション管理＞アプリケーション設計＞［任意のアプリケーション］＞［任意のフロー］＞フロー設計タブ＞新規＞ルートタブ＞承認判定
```

「プロセス コンポーネント：承認判定」は、承認機能が有効になっている時に手動処理要素と組み合わせて使用される承認判定であり、この承認判定が合意されたか否かの後に、どこに進むべきかをシステムに通知します。

### 6 承認の進め方

ユーザーに割り当てられた後、以下の方法で承認を実行できます。

#### 6.1 クイック操作

```
位置：［メインメニュー］＞私のタスク＞タスクリストタブ
```

「承認フロー」がユーザーに割り当てられると、ユーザーは「私のタスク」で承認名することができます。

> 注意事項：
>
> 1. この機能を使用するには、「承認デザイン」に「クイック操作を許可」にチェックを入れる必要があります。

#### 6.2 フォームの操作

```
位置：［メインメニュー］＞私のタスク＞タスクリストタブ＞［任意の承認フロー］
```

「私のタスク」から該当のフローで承認機能を実行でき、フォームの内容と承認記録を確認することもできます。

**6.2.1 追加承認**

承認の際、ユーザーが他の役員の同意を求める必要があり、「承認デザイン」で「追加承認を許可」にチェックが入っている場合、ユーザーはフォームの上部または下部にある「追加承認」ボタンをクリックし、以下の操作を実行できます。

1. **同意して追加承認**：「同意して追加承認」を選択する場合、承認担当者は「同意する」で承認プロセスに返送し、同時に追加承認のユーザーを選択します。ユーザーは該当の承認段階で承認に指定されしていないユーザーだけを選択することができ、このオプションで承認者として選択されたユーザーは、今回承認の担当者から完全な重み付けを取得します。
2. **意見募集して返事を待つ**：「意見募集して返事を待つ」を選択する場合、承認担当者の動作が保留され、先に追加承認者にプロセスが送信されます。承認担当者は、追加承認者のコメントが返信されるまで承認することができます。コメントが返信される前に承認担当者が承認を実行した場合、この状況がシステムによって自動的に追加承認者に返信します。ユーザーは該当の承認段階で承認に指定されしていないユーザーだけを選択することができ、追加承認者は今回の承認の重み付けを取得せず、承認担当者に保留します。

**6.2.2 意見募集**

承認の際、「承認」フィールドにコメントを入力する欄があります。承認担当者は、プロセス中にコメントやアイデアを入力し、同意するかどうかを選択し、システムはフォームフィールドに承認履歴とコメントを表示します。

### 7 代理承認

```
位置：［メインメニュー］ ＞ユーザー管理＞ユーザー管理＞ ［任意のユーザー］＞高度な代理タブ
```

ユーザーがOMFLOWで「休暇」ステータスにある場合、承認フォームにはユーザーの「代理人」に割り当てられ、以下の2つの代理人モードがあります。

#### 7.1承認代理人の新規追加

```
位置：［メインメニュー］ ＞ユーザー管理＞ユーザー管理＞ ［任意のユーザー］＞高度な代理タブ＞承認代理人
```

「承認デザイン」と「代理人」を選択し、承認が割り当てられるたびに、選択されたユーザーは代理人として行動することになります。

#### 7.2職務代理人の新規追加

```
位置：［メインメニュー］ ＞ユーザー管理＞ユーザー管理＞ ［任意のユーザー］＞高度な代理タブ＞職務代理人
```

「職務」と「代理人」を選択することで、職務から割り当てられた時、すべて該当のユーザーが代理人となります。

> 注意事項：
>
> 1. 「休暇」期間中に作成された承認フローのみが、代理人の「私のタスク」に表示されます。
> 2. 両方の代理条件を満たす場合、「承認代理人」が優先されます。

### 8 組織図の操作說明

```
位置：［メインメニュー］ ＞ユーザー管理＞組織図＞［任意の組織図］
```

```
位置：［メインメニュー］ ＞ユーザー管理＞組織図＞新規
```

#### 8.1 基本情報の設定

組織図を設計する際、まず組織図の基本情報を以下のように設定します。

1. **組織図名**：組織図名のユニークな値を入力してください。
2. **設定**：「組織図名」フィールドの右側をクリックすると、以下のような設定インターフェイスがポップアップ表示されます。
3. **フローがこの図にデータを見つからない場合、さらに部門データを検索し、条件を満足したユーザに情報を返送します**：プロセス設計の 「ダイレクト職務/権限、部門の職務/権限」のコンポーネントは、指定した組織図で設定した条件を満たす要員を優先的に検索します。 このオプションにチェックを入れた後、条件を満たすユーザーが組織図で見つからない場合、システムは部門データでさらに有資格者を検索します。
4. **管理部門&管理ユーザ**：組織図が組織の一部を委託管理責任者に「委託管理」し、委託管理責任者がそれを編集して承認に送信すると、システムは自動的にプロセス「組織図管理プロセス」フローを生成し、設定された管理者に割り当て、「私のタスク」で確認することができます。

#### 8.2 組織構成の設定

初期の「組織図」には1つの組織アイコンのみで、ツリー構造のルートディレクトリであり、通常は組織図の最上位に位置付けます。アイコンの\[歯車]ボタンをクリックして設定します。以下は関連設定の説明です。

1. **部門名** ：代表する部署を選択します。カスタムにチェックを入れる場合、バーチャル部門とみなされますので、名称を入力する必要があります。
2. **部門番号** ：上記に説明したとおり、カスタマイズにチェックが入る場合は、名前を入力し、組織図ではユニークな値である必要があります。
3. **所属部門番号** ：読み取り専用で、設計に従って所属する部門名を示す。
4. **所屬部門コード**：読み取り専用で、設計に従って部門コード示す。
5. **委託管理** ：チェックを入れた後、委託管理責任者を設定できます。
6. **委託管理責任者**：ユーザーを設定し、設定後この組織以下のツリー構造を隠し、指定したユーザーに管理権限を渡す。
7. **部門の職務/責任者**：この部門の職務と権限は、第【9】章を参照してください。

> 注意事項：
>
> (1) 部門のカスタマイズは、通常、恒久的ではない特別な部門構成で利用します。例えば、異なる部門が集まったプロジェクトチームで使用し、プロジェクトチの期間中に組織図検索機能を使って、チームメンバーにタスクを割り当てることができます。
>
> (2) 「委託管理」ボックスにチェックを入れると、システムは指定された「委託管理責任者」に組織とその下位組織を委託管理を出します。委託管理された組織は委託がキャンセルまでに編集できないことに注意してください。 「委託管理責任者」のメインメニューに「ユーザー管理＞組織図」が表示され、委託管理責任者は「委託管理」されてた組織を編集できます。保存をクリックすると「組織図リスト」ページに戻り、組織図の末尾に「審査に提出」ボタンが表示され、委託管理責任者はボタンをクリックすると、組織図に割り当てられている「管理ユーザ」は私のタスクに審査タスクが与えられ、同意すると変更を保存できます。同意しない場合、再度委託管理者に戻り、再審査またはクローズするかを尋ねます。

設定完了後、最初の「組織」アイコンの+ボタンをクリックして、その組織の下に空の組織を追加します。この手順で希望のツリー構造を作成し、「保存」ボタンをクリックして設計を完了します。

#### 8.3 その他の機能

保存ボタンのほかにも、以下のようなボタンがあります。

1. **エクスポート**：現在「保存」されている組織図をxlsxファイルにエクスポートする。
2. **インポート**：ユーザーがエクセルファイルの形でデータメンテナンスできます。

> 注意事項：\
> (1) エクセルファイルのフォーマットは決まっているので、実際にエクスポートしたエクセルファイルを参照してください。\
> (2) インポートする前に、対応する「職務、部門」情報がシステム内に作成されていることを確認してください。\
> (3) インポートの際、「部門番号とジョブコード」で追加・修正を行うを基準にします。\
> (4) 利用すると、現在の組織図の構造が変更されます。

3. **取消**：現在未保存の編集を破棄し、「組織図」リストに戻ります。

### 9 職務權限操作の說明

```
位置：［メインメニュー］ ＞ユーザー管理＞部門管理＞ ［任意の部門］＞「職務權限」
```

```
位置：［メインメニュー］ ＞ユーザー管理＞組織図＞ ［任意の組織図］＞［任意の組織図アイコン］＞歯車ボタン
```

#### 9.1 職務權限の新規追加

編集モードの「職務權限」ブロックで追加ボタンをクリックすると、関連設定は以下のようです。

1. **職務**：職務管理の「すべての職務」のドロップダウンメニューで構成する。
2. **ユーザ**：職務を任意のユーザに割り当てる。
3. **権限**：ユーザーのニーズに応じて追加、改修、削除が可能です。

#### 9.2 職務權限の削除

1. **以下の職務を削除します**：職務權限右上にあるXアイコンをクリックして「職務權限」を削除します。
2. **以下の権限を削除します**：特定の職務の権限を単独で削除します。各権限の末尾に\[ゴミ箱]アイコンがあり、クリックすると「特定の権限責任」を削除できます。ここの修正は職務管理のデフォルト権限と責任に影響しません。

> ※ 部門設定調整完成後，點選左上方的儲存按鈕即會生效。

### 10 承認デザイン操作の說明

```
位置：［メインメニュー］＞アプリケーション管理＞承認管理＞新規
```

```
位置：［メインメニュー］＞アプリケーション管理＞承認管理＞［任意の承認デザイン］
```

#### 10.1「設定」タブの操作

1. 件名：テンプレートの名前を記入する。
2. 說明：承認テンプレートの説明や備考情報を記入する。
3. 承認通知設定：\
   (1) **承認者に通知する**：「承認者に通知する」にチェックを入れると、「フロー設計」でこの「承認デザイン」が使用され、プロセス中にでこの承認メカニズムがトリガーされると、この段階の署名者に通知されます。 (2) **送信者に通知する**：「送信者に通知する」にチェックを入れると、その後の承認段階の各段階の「送信者」に通知します。\
   (3) **通知方法**：\
   **システム通知**：「システム通知」を選択すると、「承認段階」ごとに「承認通知」 がユーザーに通知を送信します。\
   **メールアドレス**：「メールアドレス」を選択すると、「承認段階」ごとに「承認通知」 がユーザーのメールアドレスに送信します。 この機能を使用する場合、メールを正常に送信するために、「パラメータ設定」で「smtp server」関連のパラメータを入力する必要があることに注意してください。\
   (4) **通知フォーマット**：\
   **プレーンテキスト**：「プレーンテキスト」　のテキスト形式を選択すると、「通知」タブに入力されたテキストが「プレーンテキスト」形式で表示されます。\
   **Html**：「html」のテキスト形式を選択すると、「通知」タブで「htmlタブ」の形式でテキストの内容が表示されます。

#### 10.2 入力タブの操作

1. **内蔵パラメータ**：「承認デザイン」の内蔵パラメータであり、「通知」タブと「Python」タブで使用でき、「通知」タブで使用する場合は「内蔵パラメータ」を{}に入れれば利用できます。
2. **変数入力**：「変数入力」とは、変数を「承認デザイン」と「プロセス」でそれぞれ「名前」と「値」が与えられ、「段階」タブで使用します。

#### 10.3 「段階」タブの操作

1. **新規**：「新規」ボタンをクリックして、新しい「承認段階」 を追加する。\
   (1) **件名** ：承認段階の「件名」を入力するフィールドです。  (2) **說明** ：承認段階の「說明」を入力するフィールドです。
2. **承認段階を設定**：承認段階の設計。\
   (1) **クイック操作を許可**：「クイック操作を許可」をチェックすると、承認者は、\[メインメニュー]>私のタスク>タスクリスト>「クイック操作」で、今回の審査に同意または拒否を直接選択できます。 (2) **追加承認を許可**：「追加承認を許可」にチェックを入れると、その後の審査の段階では「追加承認を許可」ボタンが表示され、この段階ではまだ「承認者」でないユーザーを「追加承認者」に指定できます。 (3) **複数承認**：「複数承認」にチェックを入れると、この段階で新たに「承認者」を追加することができ、承認フローが複数の承認者に同時に送信され、「承認結果を判断」ブロックが表示され、以下の「3つの判定方法」のいずれかを選択できます。 **全員が同意する**：「全員が同意する」が選択された場合、すべての承認者が同意しない限り、次のステージに進みません。拒否がある場合、結果は拒否になりこの承認フローが終了します。 **重み付けの境界**：「重み付けの境界」を選択すると、「承認の重み付けが境界に達する場合は次のように見なされる」ブロック、「カスタム重み付け」チェックボックス、「承認の重み付けの閾値までで今のフェーズを終了」チェックボックスが表示されます。それぞれの説明は下記のとおりです。「承認の重み付けが境界に達する場合は次のように見なされる」は2つのチェックボックスがあり、「同意する」にチェックを入れ、重み付けがしきい値に達すると、署名段階の結果は「同意する」となり、「拒否」にチェックを入れると、結果は「拒否」となります。「承認の重み付けの閾値までで今のフェーズを終了」は、重み閾値に達したときに、すべての署名監督者の回答が終わるのを待たずに、署名段階を終了することができる項目です。 **重み付けの比較**：「重み付けの比較」を選択すると、「承認の重み付けが同等の場合は」ブロックと、「カスタム重み付け」というチェックボックスが表示されます。 「承認の重み付けが同等の場合は」には、「同意する、拒否する」の2つのチェックボックスがあります。「同意する」にチェックを入れると、承認の段階で、「同意する」と「拒否する」の重みの合計が等しい場合、結果は「同意する」と判定されます。「拒否」にチェックを入れると「拒否」となります。「カスタム重み付け」にチェックを入れると、承認者の重み付けフィールドのロックが解除され、 ユーザーが設定したい重み付けを入力できるようになります。そのため、重み付けフィールドが変更されると、「カスタム重み付け」のオプションは自動的にチェックが入れます。 (4) **承認者**：ここでは、フローを発送する「承認者」を検索または指定することができ、「入力」タブで入力した「変数入力」と合わせて利用することができます。承認者ブロックには、「重み付け、名前、種類、承認者」のフィールドがあり、それぞれのブロックの機能は次のように説明します。 **重み付け**：このフィールドの値は「複数承認」状態にカスタマイズでき、承認結果に影響する。\
   **名前**：このフィールドには、「承認者」の名前を入力できます。\
   **種類**：このフィールドには、承認者の「送付フロー」を検索でき、「指定者」、「組織図検索」、「部門検索」、「外部検索」の4つの種類があり、それぞれについて以下に説明します。

> **指定者**：「承認者」フィールドの後に部門とユーザーメニューが表示され、指定したい部門やユーザーを選択し、または「変数」を入力します。
>
> **組織図検索**：「承認者」フィールドの後に組織図名と検索方法メニューが表示され、「組織図名」に検索したい組織図名や「変数」を入力し、「検索方法」で検索方法を選択します。詳細は第10.4章を参照してください。
>
> **部門查詢**：「承認者」フィールドに検索方法メニューが表示され、詳細は第10.4章を参照してください。
>
> **外部検索**：PythonタブでPythonコードを使用して承認者を検索することができます。システムが自動的に検索した承認者を外部検索フィールドに記入します。

#### 10.4 検索方法

承認デザインにおける検索方法について紹介します。「承認者」ブロックの種別で「組織図検索、部門検索」を選択すると、「承認者」フィールドに検索方法メニューが表示され、「ダイレクト職務、ダイレクト権限、部門の職務、部門の権限」の4種類があり、それぞれについて以下のように説明します。

1. **ダイレクト職務**：ダイレクト職務で検索する場合、後方のフィールドに「職務名」、「ユーザ番号」を入力するか、「変数」または「内蔵パラメータ」を選択する必要があります。システムは「組織図」/「部門管理」のユーザ番号に従って入力した職務名を検索しします。

> ※検索結果のユーザー番号と同じ場合は、検索を上方向に続けて対象者を探します。

```
例：

検索条件の職務名に部長と入力し、ユーザAのユーザ番号が1の場合、検索条件はＡがいる部門のユーザを検索し、さらに上方に検索して、承認責となる職務が部長であるユーザを探すことです。
```

2. **ダイレクト権限**：ダイレクト権限で検索する場合、後方のフィールドに「権限名」、「ユーザ番号」を入力するか、「変数」または「内蔵パラメータ」を選択する必要があります。システムは「組織図」/「部門管理」のユーザ番号に従って入力した権限名を検索しします。

> ※検索結果のユーザー番号と同じ場合は、検索を上方向に続けて対象者を探します。

```
例：

検索条件の権限名に予算配分と入力し、ユーザBのユーザ番号が2の場合、検索条件はBがいる部門のユーザを検索し、さらに上方に検索して、予算配分権限がある承認責を探すことです。
```

3. **部門の職務**：部門の業務で検索する場合、後方のフィールドに「職務名」と「部門コード」を入力する必要があり、システムは部門コードに従って「組織図」/「部門管理」に入力した職務名を検索します。
4. **部門の権限**：部門の権限で検索する場合、後方のフィールドに「権限名」と「部門コード」を入力する必要があり、システムは部門コードに従って「組織図」/「部門管理」に入力した権限名を検索します。

### 11 フォーム入力コンポーネント-承認機能の起動と操作の說明

```
位置：［メインメニュー］＞アプリケーション管理＞アプリケーション設計＞［任意のアプリ］＞［任意のフロー］＞フロー設計タブ ＞フォーム入力コンポーネント＞タブの設定＞承認機能を有効にする
```

#### 11.1 「設定」タブの操作

承認機能を有効にするチェックボックスを入れると、「設定」タブに「送信者を指定」メニューと「直接送信」チェックボックスが表示されます。

1. **送信者を指定**：ここに今回の「送信者」ユーザー番号を記入でき、プロセス変数で代用することもできます。送信者を設定すると、承認者は\[メインメニュー]→私のタスク→「割り当てられたデータ」で「送信者名」を確認できるようになり、承認プロセス中に承認者を検索照会する際に、「送信者」で組織図を検索することもできます。
2. **直接送信**：通常、システムは承認フローを「譲受人」に送り、譲受人はそれが正しいことを確認した後、承認フローを承認者に送信します。 しかし、設定時点で「直接送信」にチェックを入れると、承認フローは譲受人を経由せず、直接承認者に送信して承認処理が行われます。
3. **その他の状況**：「譲受人、直接送信」のそれぞれの条件でシステムが送信者を決定する状況を以下に示します。

* 「直接送信」 → 「送信者」未指定 → 「送信者」は「system」
* 「直接送信」 → 送信者を指定 →「 送信者」は「指定送信者」
* 非「直接送信」 → 送信者未指定 → 譲受人あり → 「送信者」は「譲受人」
* 非「直接送信 」 → 送信者未指定 → 譲受人なし → 「送信者」は管理者
* 非「直接送信」 → 送信者を指定 → 譲受人あり/なし → 「送信者」は「指定送信者」
* 非「直接送信」 → 送信者を指定 → 譲受人あり/なし → 「送信者」は「指定送信者」

#### 11.2 「承認」タブの操作

```
位置：［メインメニュー］＞アプリケーション管理＞アプリケーション設計＞［任意のアプリ］＞［任意のフロー］＞フロー設計タブ ＞フォーム入力コンポーネント＞タブの設定＞承認機能を有効にする>承認タブ
```

このタブの主な目的は、ユーザーがフォーム入力コンポーネントで承認を送付する際に、承認デザインに必要な入力変数を以下のように設定します。

1. **新規**：「承認」タブの左上隅にある追加を使用することで、異なる「承認デザイン」を追加することができます。
2. **承認タイプ**：「承認タイプ」は、「承認管理」の署名デザインから選択できます。
3. **ユーザーによる調整を許可**：「ユーザーによる調整を許可」がチェックに入っている場合、「譲受人」は「承認」を送信する前に、「新しい段階を追加」するかどうかを決定することができ、システム上では「追加承認」と設定されます。
4. **条件**：承認デザインごとに条件を設定することができ、条件を満たした「承認デザイン」が表示され、「送信者」が選択することができます。
5. **承認設定**：承認設定ブロックには、「入力、段階」の 2 つのタブがあり、「入力」タブで承認デザイン「変数入力」に値を割り当て、「段階」タブで承認デザインの各段階の条件を設定できます。
